<!doctype html>
<html>
<head>
	<meta charset=utf-8>
	<meta http-equiv=X-UA-Compatible content=IE=edge>
	<meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<title>Particles</title>
	<script src=https://unpkg.com/dyo></script>
</head>
<body>
	<div id=main></div>

	<style>
		body {overflow-x: hidden;}
		#main {width: 100%;height: 100%;overflow: hidden;position: fixed;top: 0;left: 0;}
		#main > div {width: 100%;height: 100%;position: relative;}
		#main span {position: absolute;left: 0;top: 0;width: 3px;height: 3px;background-color: rgb(52,46,33);border-radius: 12px;opacity: 0.8;}
	</style>

	<script>
		const {h, render} = dyo
		const damping = 0.999
		const width  = window.innerWidth
		const height = window.innerHeight

		const Particle = ({x, y}, {state, x = state.oldX = Math.random() * width, y = state.oldY = Math.random() * height}) => {
			const velocityX = (state.x - state.oldX) * damping
			const velocityY = (state.y - state.oldY) * damping

			state.oldX = state.x
			state.oldY = state.y

			state.x += velocityX
			state.y += velocityY

			const dx = x - state.x
			const dy = y - state.y
			const distance = Math.sqrt(dx * dx + dy * dy)

			state.x += dx / distance
			state.y += dy / distance

			return h('span', {style: {transform: 'translate3d('+ state.x + 'px,' + state.y + 'px, 0px)'}})
		}

		const handleMousemove = ({clientX: x, clientY: y}, props, state) => ({x, y})

		const Particles = ({length}, {x = width * 0.5, y = height * 0.5}) => {
			for (var i = 0, children = []; i < length; i++) {
				children[i] = h(Particle, {x: x, y: y})
			}
			return h('div', {onMouseMove: handleMousemove}, children)
		}

		const main = document.getElementById('main')

		requestAnimationFrame(function loop{
			render(h(Particles, {length: 600}), container)
			requestAnimationFrame(loop)
		})
	</script>
</body>
</html>
