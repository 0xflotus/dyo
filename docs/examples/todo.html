<!doctype html>
<html>
	<head>
		<meta charset=utf-8>
		<meta http-equiv=X-UA-Compatible content=IE=edge>
		<meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<title>Todo App</title>
		<script src=https://unpkg.com/dyo></script>
	</head>
	<body>
		<script>
			const {h, render} = Dyo

			const TodoApp = (props, {todos = []}) => (
		  	h('main', {style: {fontFamily: 'sans-serif', background: '#eee', padding: '20px'}},
					h('h2', 'Todos:'),
		  		h('ol', todos.map(props => h(TodoItem, props))),
		  		h('form', {onSubmit: event => (
						props.value && {value: props.value = '', todos: todos.concat({key: Math.random(), done: event.preventDefault(), value: props.value})}
					)}, h(FormInput, props), h('button', 'Add Todo'))
		  	)
		  )

		  const TodoItem = (props, {done = props.done, value = props.value}) => (
		  	h('li', {style: {margin: '8px 0', textTransform: 'capitalize'}},
		  		h('label',
		  			h('input', {type: 'checkbox', checked: done, style: {marginRight: '5px'}, onInput: event => ({done: props.done = !done})}),
		  			h('span', {style: done && {color: 'rgba(0,0,0,.3)', textDecoration: 'line-through'}}, value)
		  		)
		  	)
		  )

			const FormInput = (props, {value = props.value}) => (
				h('input', {onInput: event => ({value: props.value = event.target.value}), value: value}),
			)

			render(h(TodoApp), document)
		</script>
	</body>
</html>
