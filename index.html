<script src="https://unpkg.com/lodash@4.17.11/lodash.js"></script>
<script src="https://unpkg.com/platform@1.3.5/platform.js"></script>
<script src="https://unpkg.com/benchmark@2.1.4/benchmark.js"></script>

<script type="module">
	import {h, render} from './server/index.js'
	const {createElement: e} = React
	const {renderToString} = ReactDOMServer

	function FibReact ({n}) {
		return n < 2 ? e('div', {},
			e('h1', {className: n}, n + 0),
			e('h1', {className: n}, n + 1),
			e('h1', {className: n}, n + 2),
			e('h1', {className: n}, n + 3),
			e('h1', {className: n}, n + 4),
			e('h1', {className: n}, n + 5),
			e('h1', {className: n}, n + 6),
			e('h1', {className: n}, n + 7),
			e('h1', {className: n}, n + 8),
			e('h1', {className: n}, n + 9),
		) : e('div', {}, e('h1', {className: n - 1}, n - 2), e(FibReact, {n: n - 1}))
	}

	function FibDyo ({n}) {
		return n < 2 ? h('div', {},
			h('h1', {className: n}, n + 0),
			h('h1', {className: n}, n + 1),
			h('h1', {className: n}, n + 2),
			h('h1', {className: n}, n + 3),
			h('h1', {className: n}, n + 4),
			h('h1', {className: n}, n + 5),
			h('h1', {className: n}, n + 6),
			h('h1', {className: n}, n + 7),
			h('h1', {className: n}, n + 8),
			h('h1', {className: n}, n + 9),
		) : h('div', {}, h('h1', {className: n - 1}, n - 2), h(FibDyo, {n: n - 1}))
	}

	var suite = new Benchmark.Suite

	suite.add('Dyo:noop', function () {
		render(h(FibDyo, {n: 20}), {}) // empty object to mimic new response object
	}).on('cycle', function(event) {
		console.log(String(event.target))
	}).on('complete', function() {
	  console.log('Fastest is ' + this.filter('fastest').map('name'));
	}).run({ 'async': true })
</script>
