<body>
	<div id="root"></div>
	<script src=dist/dio.umd.js></script>
	<script>
		const {h, render, Component} = dio
		const root = document.getElementById('root')

		class ContextProvider extends Component {
		  getChildContext() {
		  	console.log(this)
		    return {data: this.props.currentUser + ' - ' + performance.now()};
		  }
		  shouldComponentUpdate () {

		  }
		  // getInitialState() {
		  	// console.log('getInitialState')
		  	// return Promise.resolve({id: true})
		  // }
		  componentWillMount(node) {
		  	// console.log('componentWillMount', node)
		  }
		  componentDidMount(node) {
		  	// console.log('componentDidMount', node)
		  }
		  componentWillUpdate(node) {
		  	// console.log('componentWillUpdate')
		  }
		  componentDidUpdate(node) {
		  	// console.log('componentDidUpdate')
		  }
		  render() {
		  	return h(ContextConsumer, this.props)
		  }
		}

		var iterable = {
			[Symbol.iterator]: function* () {
			    yield 1
			    yield 2
			    yield 3
			}
		}

		class ContextConsumer {
		  render(props, state, context) {
		  	return h(Foo, this.props)
		  	// throw 'error'
		  	// return h('h1', {id: 1, class: 1}, 'Hello')
		  	// return h('h1', {tabIndex: 20})
		  	// return h('svg', {width: 100, height: 100, innerHTML: '<text>hi<text>'})

		  	// return h('img', {src: '', style: 'background:red', width: '400%', height: '400%'})
		  	// return h('svg', {src: '', style: 'background:red', width: '400em', height: '400em'})
		  	// return h('svg', {'xlink:href': 'hello'})
		  	// return h('button', {
		  	// 	onClick: (e) => {
		  	// 		console.log(e)
		  	// 	}
		  	// }, 'Click Me')

		  	// return new Date()
		  	// return h(
		  	// 	new Promise((resolve) => {
		  	// 		setTimeout(resolve, 1000, 'Hello '+new Date() + ' - ' + counter++)
		  	// 	}),
		  	// 	'Loading...'
		  	// )
		  	// return Promise.resolve('Hello World')
		  	// return function* () {
		  	// 	yield 1
		  	// 	yield 2
		  	// }
		  	// h('h1', iterable)  	
		  	// return iterable

		  	// return Promise.resolve(performance.now())
		  	// return h(Promise.resolve(performance.now()))
		  	// return h('h1', {color: 'red'}, 1, Promise.resolve(performance.now()))
		  	return {props, state, context}
		  }
		}

		const handleClick = function (event) {
			return {name: 'handleClick', time: new Date}
		}

		const animation = {
			fadeOut: [
			  {transform: 'translateY(0)', opacity: 1},
		  	{transform: 'translateY(-120%)', opacity: 0}
		  ],
		  fadeIn: [
			  {transform: 'translateY(-120%)', opacity: 0},
		  	{transform: 'translateY(0%)', opacity: 1}
		  ]
		}

		var counter = 0

		class Foo {
			getInitialState() {
				var value = '1,2,3,4,5'
				// var value = '0,2,4,6,8'
				// var value = 'a,b,d,f,c'
				
				return {data: value.split(/,\s*/), value: value}
			}
			handleInput({target}) {
				return {value: target.value}
			}
			handleSubmit({target}) {
				// var value = '1,4,0,3,2,5'
				// var value = 'c,b,d,r,a'
				// var value = '0,1,2,3,4,5,6,7,8'
				// var value = '2,3,4,5,1'
				// var value = '5,1,2,3,4'
				// var value = '5,4,3,2,1'
				// var value = '5,4,3,0,2,1'
				// var value = '5,4,3,2,1'
				// var value = '5,4,3,2,1'
				// var value = '6,5,4,3,2,1'
				// var value = '1,2,3,4,5'
				// counter++
				return {data: value.split(/,\s*/), value: value}
			}
			render(props, {data, value}) {
				const input = h('input', {onInput: this.handleInput, value: value})
				const button = h('button', {onClick: this.handleSubmit}, 'Submit')
				const list = h('ul',
					data.map(value => {
						return [
							h('li', {key: value}, value+' - '+counter),
							'#Frag'
						]
					})
				)
				// const list = h('ul', data.map(value => h('li', {key: value}, value+' - '+counter)))

				return h('div', input, button, list)
			}
		}

		class Listing {
			render({data}) {
				return data.map(value => h('li', {key: value}, value+' - '+counter))
			}
		}

		// render(h('h1', {style: 'color:red;'}, 'Hello World'))

		// element = h('ul',
		// 	h('li', {key: 0}, 0)
		// 	h('li', {key: 1}, 1),
		// 	[
		// 		h('li', {key: 0}, 0)
		// 		h('li', {key: 1}, 1)
		// 	]
		// )

		// render(
		// 	h('ul',
		// 		h('li', {key: 0}, '0.0'),
		// 		h('li', {key: 1}, '0.1'),
		// 		[
		// 			h('li', {key: 0}, '1.0'),
		// 			h('li', {key: 1}, '1.1')
		// 		]
		// 	)
		// )

		// render(
		// 	h('ul',
		// 		h('li', {key: 0}, '0.0'),
		// 		h('li', {key: 1}, '0.1'),
		// 		[
		// 			// h('li', {key: 0}, '1.0')
		// 			h('li', {key: 1}, '1.1')
		// 		]
		// 	)
		// )

		// requestAnimationFrame(()=>{
		// 	console.log(element.children.length)
		// })

		// "0|0|0", 
		// "0|1|1", 
		// "1|2|0", 
		// "1|3|1"

		// console.log(el)

		// render()
		// render(h(Foo, {currentUser: 'Sultan'}))

		setTimeout(()=>{
			// render(h('div', 'removed'))
		}, 2000)

		// function Foo (props, state) {
		// 	return h('div', h('button', {onClick: handleClick, ref: 'button'}, 'Click Me!'), {...props, ...state})
		// }

		// Foo.componentDidMount = () =>({name: 'componentDidMount', time: new Date})
		// Foo.componentWillMount = ()=> ({name: 'componentWillMount', time: new Date})
		// Foo.componentWillUpdate = () => ({name: 'componentWillUpdate', time: new Date})
		// Foo.componentDidUpdate = async () => ({name: 'componentDidUpdate', time: new Date})
		// Foo.getInitialState = () => ({name: 'getInitialState', time: new Date})

		// class Foo {
		// 	componentDidCatch(error) {
		// 		return h('div', {color: 'red'}, error)
		// 	}
		// 	render (props, state, context) {
		// 		// console.log(this)
		// 		// return h(Bar, {ref: 'button'})

		// 		return h('div', h('button', {onClick: handleClick, ref: 'button'}, 'Click Me!'), this.state)
		// 	}
		// }

		// Foo.defaultProps = {
		// 	statement: 'hello world'
		// }

		class Bar {
			componentDidCatch() {
				// throw new Error('bar')
			}
			async render() {
				// console.log(1)
				// return await resolveAfter2Seconds('Hello world')

				return h('div', h('button', {onClick: handleClick}, 'Click Me!'))
			}
		}

		// render(h(ContextProvider, {currentUser: 'Sultan'}))
		
		// setTimeout(()=>{
			// render(h(ContextProvider, {currentUser: 'Tarimo'}))
			// render(null)
			// render(h(ContextProvider, {key: 'Sultan'}))
		// }, 2000)

		var stages = []

		class A {
			componentWillUnmount() {
				stages.push('1')
			}
			render(){
				return h('div', 'A')
			}
		}

		class B {
			componentDidUpdate() {
				stages.push('5')
			}
			componentWillUpdate(nextProps, nextState) { 
				stages.push('4')
			}
			shouldComponentUpdate() {
				stages.push('3')
			}
			componentWillReceiveProps() {
				stages.push('2')
			}
			componentWillMount() {
				stages.push('0')
			}
			render(){
				return h('div', 'B')
			}
		}

		// render(h(A), root)
		// render(h(B), root)
		// render(h(B), root)

		var iterable = {
			[Symbol.iterator]: function* () {
			    yield 1
			    yield 2
			    yield 3
			}
		}
		const Test = () => iterable

		class List {
			render () {
				return h('ul',
					this.props.data.map(v => h('li', {key: v}, v))
				)
			}
		}

		// class Main {
			// componentDidCatch(err) {
				// console.log(err, 'componentDidCatch')
				// return h('h1', {style: 'color:red'}, 'Error!')
			// }
		// 	render(){
		// 		return Child
		// 	}
		// }

		class Child {
			componentDidMount() {
				throw new Error('error')
			}
			render(){
				return h('h1', 'Hello')
			}
		}

		// render(Main)

		// render([h('h1', 'Hello'), h(root, h('h1', 'World'))])

		// var counter = 0
		// function Load () {
		// 	return h('h1', 'Loaded - ', counter++)
		// }

		// var then = new Promise((resolve)=>{
		// 	setTimeout(function () {
		// 		resolve(h(Load))
		// 	}, 1000)
		// })

		// render(h('div', 1, h(then, 'Loading')))
		// render(h('div', 1, h(root, 'Loading')))
		// render(h('div', 1, h(root, 2, 3)))

		// render([1, h(then, 'Loading')])
		
		// setTimeout(function (){
			// render(h('div', 1))
			// render(h('div', 1, h(root, 2)))
			// render(h(then, 'Loading'))
		// }, 2000)
		
		// dio.render(Main)

		class Timer {
		  constructor(props, context) {
		    // super(props)
		    console.log(props, context)
		    this.state = { secondsElapsed: 0 }
		  }

		  tick() {
		    this.setState(prevState => ({
		      secondsElapsed: prevState.secondsElapsed + 1
		    }))
		  }

		  componentDidMount() {
		  	// throw 'end'
		    // this.interval = setInterval(() => this.tick(), 1000)
		  }

		  componentWillUnmount() {
		    clearInterval(this.interval)
		  }

		  componentDidCatch(err) {
		  	return err
		  	// console.dir(err)
		  	// return {...err}
		  }

		  handleEvent(e) {
		  	this.setState({}, ()=>{
		  		throw 'end'
		  	})
		  	// console.log(e)
		  	// throw 'end'
		  }

		  render() {
		  	// return h(null)
		  	// throw 'end'
		    return (
		    	[
		    		h('div', 'Seconds Elapsed:', this.state.secondsElapsed),
		    		h('button', {onClick: this}, 'button')
		    	]
		    )
		  }
		}

		var ref = (e) => {console.log(e)}

		class Main {
			componentDidCatch(err){
				// console.log(1)
				// return h('h1', {style: 'color:red'}, 'Error', {...err})
			}
		  render(){
		  	return [
		  		h('head', 
		  			h('title', 'Hello World', performance.now()),
		  		),
		  		'Hello World',
		  		h('body', 
		  			h(Timer, {ref: ref})
		  		)
		  	]
		  }
		}

		window.onerror = function (msg, url, lineNo, columnNo, error) {
			console.log(msg, url, lineNo, columnNo, error)
	    // var string = msg.toLowerCase();
	    // var substring = "script error";
	    // if (string.indexOf(substring) > -1){
	    //     alert('Script Error: See Browser Console for Detail');
	    // } else {
	    //     var message = [
	    //         'Message: ' + msg,
	    //         'URL: ' + url,
	    //         'Line: ' + lineNo,
	    //         'Column: ' + columnNo,
	    //         'Error object: ' + JSON.stringify(error)
	    //     ].join(' - ');

	    //     alert(message);
	    // }

	    return false
		};

		// throw 'end'

		// dio.render(h(Main, null, 1, 2))

		// setTimeout(function foo () {
			dio.render(h(Main, null, 1, 2))
			// setTimeout(foo, 1000)
		// })
		
		class Hello {
			render () {
				return h('h1', 'Hello World')
			}
		}


		// dio.hydrate(Hello, root)
	</script>
</body>
