<body>
	<div id="root"></div>
	<script src=dist/dio.umd.js></script>
	<script>
		const {h, render, Component} = dio
		const root = document.getElementById('root')

		var iterable = {
			[Symbol.iterator]: function* () {
			    yield 1
			    yield 2
			    yield 3
			}
		}

		const animation = {
			fadeOut: [
			  {transform: 'translateY(0)', opacity: 1},
		  	{transform: 'translateY(-120%)', opacity: 0}
		  ],
		  fadeIn: [
			  {transform: 'translateY(-120%)', opacity: 0},
		  	{transform: 'translateY(0%)', opacity: 1}
		  ]
		}

		const handleClick = function (event) {
			return {name: 'handleClick', time: new Date}
		}

		class ContextProvider extends Component {
		  getChildContext() {
		    return {data: this.props.currentUser + ' - ' + performance.now()};
		  }
		  componentWillUnmount(node) {
	  		return new Promise((resolve) => {
	  			node.animate(animation.fadeOut, {
	  				duration: 200
	  			}).onfinish = resolve
	  		})
		  }
		  render() {
		  	return h(ContextConsumer, this.props)
		  }
		}

		class ContextConsumer {
		  render(props, state, context) {
		  	return h(Foo, this.props)
		  }
		}

		function Foo (props, state, context) {
			return h('div', h('button', {onClick: handleClick, ref: 'button'}, 'Click Me!'), {...props, ...state, ...context})
		}

		Foo.defaultProps = {
			statement: 'hello world'
		}

		class Bar {
			async render(props, state) {
				return h('div', h('button', {onClick: handleClick}, 'Click Me!'), {...state})
			}
		}

		class Timer {
		  constructor(props, context) {
		    this.state = { secondsElapsed: 0 }
		  }

		  tick() {
		    this.setState(prevState => ({
		      secondsElapsed: prevState.secondsElapsed + 1
		    }))
		  }

		  componentDidMount() {
		    // this.interval = setInterval(() => this.tick(), 1000)
		  }

		  componentWillUnmount() {
		    clearInterval(this.interval)
		  }

		  componentDidCatch(err) {
		  	return err
		  }

		  handleEvent(e) {
		  	// console.log('works', e.target, e.currentTarget)
		  	return {secondsElapsed: this.state.secondsElapsed + 1}
		  	// this.setState({}, ()=>{
		  	// 	throw 'end'
		  	// })
		  }

		  render() {
		    return (
		    	[
		    		h('div', 'Seconds Elapsed:', this.state.secondsElapsed),
		    		h('div', {style: 'background:red;', onClick: this}, h('button', {onClick: null}, 'button'))
		    	]
		    )
		  }
		}

		class Main {
			componentDidMount(){
				console.log('componentDidMount')
			}
		  render() {
		  	return [
		  		h('head', 
		  			h('title', 'Hello World', performance.now()),
		  		),
		  		'Hello World',
		  		h('body', {ref: (e)=>console.log(e)},
		  			h(Timer, {ref: (e) => {console.log(e)}})
		  		)
		  	]
		  }
		}

		class Hello {
			render({remove}) {
				return h('body', 
					h(ContextProvider, {currentUser: 'Sultan'})
				)
			}
		}

		// dio.Children.only(1)

		// dio.render(h(Hello, {remove: false}))
		// dio.render(Hello, {remove: true})

		dio.render(h(Main))
		// dio.render(h(ContextProvider, {currentUser: 'Sultan'}))
	</script>
</body>
